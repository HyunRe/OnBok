<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <header th:replace="~{fragments/base :: head}"></header>
  <style>
    .book-card {
      border: 1px solid #ddd;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: box-shadow 0.3s;
    }
    .book-card:hover {
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .section-title {
      margin-top: 30px;
      margin-bottom: 20px;
      border-bottom: 2px solid #007bff;
      padding-bottom: 10px;
    }
  </style>
</head>
<body>
<div th:insert="~{fragments/base :: top}"></div>

<div class="container" style="margin-top:80px">
  <div class="row">
    <div class="col-3">
      <aside th:replace="~{fragments/base :: aside('/img/recommendation.png')}"></aside>
    </div>

    <div class="col-9">
      <main>
        <h3><strong>도서 추천</strong></h3>
        <hr>

        <!-- 주문 기반 추천 -->
        <h4 class="section-title">구매 이력 기반 추천</h4>
        <div th:if="${orderBased.isEmpty()}" class="alert alert-info">
          구매 이력이 없어 추천할 도서가 없습니다.
        </div>
        <div class="row">
          <div th:each="book : ${orderBased}" class="col-md-4 col-sm-6 mb-3">
            <div class="book-card" th:onclick="|location.href='@{/view/books/detail/{id}(id=${book.id})}'|">
              <img th:src="${book.imageUrl}" style="width:100%; height:200px; object-fit:cover;" alt="Book Image">
              <h6 class="mt-2" th:text="${book.title}">책 제목</h6>
              <p class="text-muted mb-1" th:text="${book.author}">저자</p>
              <p class="text-primary" th:text="|${#numbers.formatInteger(book.price, 0, 'COMMA')}원|">가격</p>
            </div>
          </div>
        </div>

        <!-- 리뷰 기반 추천 -->
        <h4 class="section-title">내 리뷰 기반 추천</h4>
        <div th:if="${reviewBased.isEmpty()}" class="alert alert-info">
          작성한 리뷰가 없어 추천할 도서가 없습니다.
        </div>
        <div class="row">
          <div th:each="book : ${reviewBased}" class="col-md-4 col-sm-6 mb-3">
            <div class="book-card" th:onclick="|location.href='@{/view/books/detail/{id}(id=${book.id})}'|">
              <img th:src="${book.imageUrl}" style="width:100%; height:200px; object-fit:cover;" alt="Book Image">
              <h6 class="mt-2" th:text="${book.title}">책 제목</h6>
              <p class="text-muted mb-1" th:text="${book.author}">저자</p>
              <p class="text-primary" th:text="|${#numbers.formatInteger(book.price, 0, 'COMMA')}원|">가격</p>
            </div>
          </div>
        </div>

        <!-- 협업 필터링 추천 -->
        <h4 class="section-title">비슷한 취향의 사용자들이 구매한 도서</h4>
        <div th:if="${collaborative.isEmpty()}" class="alert alert-info">
          추천할 도서가 없습니다.
        </div>
        <div class="row">
          <div th:each="book : ${collaborative}" class="col-md-4 col-sm-6 mb-3">
            <div class="book-card" th:onclick="|location.href='@{/view/books/detail/{id}(id=${book.id})}'|">
              <img th:src="${book.imageUrl}" style="width:100%; height:200px; object-fit:cover;" alt="Book Image">
              <h6 class="mt-2" th:text="${book.title}">책 제목</h6>
              <p class="text-muted mb-1" th:text="${book.author}">저자</p>
              <p class="text-primary" th:text="|${#numbers.formatInteger(book.price, 0, 'COMMA')}원|">가격</p>
            </div>
          </div>
        </div>

        <!-- 인기 도서 -->
        <h4 class="section-title">
          인기 도서
          <a href="/view/recommendations/popular" class="btn btn-sm btn-outline-primary float-end">더보기</a>
        </h4>
        <div class="row">
          <div th:each="book : ${popular}" class="col-md-4 col-sm-6 mb-3">
            <div class="book-card" th:onclick="|location.href='@{/view/books/detail/{id}(id=${book.id})}'|">
              <img th:src="${book.imageUrl}" style="width:100%; height:200px; object-fit:cover;" alt="Book Image">
              <h6 class="mt-2" th:text="${book.title}">책 제목</h6>
              <p class="text-muted mb-1" th:text="${book.author}">저자</p>
              <p class="text-primary" th:text="|${#numbers.formatInteger(book.price, 0, 'COMMA')}원|">가격</p>
            </div>
          </div>
        </div>

        <!-- 평점 높은 도서 -->
        <h4 class="section-title">
          평점 높은 도서
          <a href="/view/recommendations/highly-rated" class="btn btn-sm btn-outline-primary float-end">더보기</a>
        </h4>
        <div class="row">
          <div th:each="book : ${highlyRated}" class="col-md-4 col-sm-6 mb-3">
            <div class="book-card" th:onclick="|location.href='@{/view/books/detail/{id}(id=${book.id})}'|">
              <img th:src="${book.imageUrl}" style="width:100%; height:200px; object-fit:cover;" alt="Book Image">
              <h6 class="mt-2" th:text="${book.title}">책 제목</h6>
              <p class="text-muted mb-1" th:text="${book.author}">저자</p>
              <p class="text-primary" th:text="|${#numbers.formatInteger(book.price, 0, 'COMMA')}원|">가격</p>
            </div>
          </div>
        </div>

      </main>
    </div>
  </div>
</div>
</body>
</html>
